<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ARTS: jacobian.cc File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ARTS
   &#160;<span id="projectnumber">2.0.49</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('jacobian_8cc.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">jacobian.cc File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Routines for setting up the jacobian.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="arts_8h_source.html">arts.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="jacobian_8h_source.html">jacobian.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="special__interp_8h_source.html">special_interp.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="physics__funcs_8h_source.html">physics_funcs.h</a>&quot;</code><br />
</div>
<p><a href="jacobian_8cc_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:afe8ca4da49b69f5a7aa83b641748ce03"><td class="memItemLeft" align="right" valign="top">ostream &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jacobian_8cc.html#afe8ca4da49b69f5a7aa83b641748ce03">operator&lt;&lt;</a> (ostream &amp;os, const <a class="el" href="classRetrievalQuantity.html">RetrievalQuantity</a> &amp;ot)</td></tr>
<tr class="memdesc:afe8ca4da49b69f5a7aa83b641748ce03"><td class="mdescLeft">&#160;</td><td class="mdescRight">Output operator for <a class="el" href="classRetrievalQuantity.html" title="Contains the data for one retrieval quantity.">RetrievalQuantity</a>.  <a href="jacobian_8cc.html#afe8ca4da49b69f5a7aa83b641748ce03">More...</a><br /></td></tr>
<tr class="separator:afe8ca4da49b69f5a7aa83b641748ce03"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4a739deb98ebee7f6e70ee0a85901efd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jacobian_8cc.html#a4a739deb98ebee7f6e70ee0a85901efd">calc_nd_field</a> (<a class="el" href="classTensor3View.html">Tensor3View</a> &amp;nd, const <a class="el" href="classVectorView.html">VectorView</a> &amp;p, const <a class="el" href="classTensor3View.html">Tensor3View</a> &amp;t)</td></tr>
<tr class="memdesc:a4a739deb98ebee7f6e70ee0a85901efd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the number density field.  <a href="jacobian_8cc.html#a4a739deb98ebee7f6e70ee0a85901efd">More...</a><br /></td></tr>
<tr class="separator:a4a739deb98ebee7f6e70ee0a85901efd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adba747ee343e17e6d1276a45f76a36e5"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jacobian_8cc.html#adba747ee343e17e6d1276a45f76a36e5">check_retrieval_grids</a> (<a class="el" href="array_8h.html#abd238db55339e04459dc977232efcab2">ArrayOfVector</a> &amp;grids, ostringstream &amp;os, const <a class="el" href="classVector.html">Vector</a> &amp;p_grid, const <a class="el" href="classVector.html">Vector</a> &amp;lat_grid, const <a class="el" href="classVector.html">Vector</a> &amp;lon_grid, const <a class="el" href="classVector.html">Vector</a> &amp;p_retr, const <a class="el" href="classVector.html">Vector</a> &amp;lat_retr, const <a class="el" href="classVector.html">Vector</a> &amp;lon_retr, const <a class="el" href="mystring_8h.html#ab1ff59b63d1f9de0285e8c12fa7a1408">String</a> &amp;p_retr_name, const <a class="el" href="mystring_8h.html#ab1ff59b63d1f9de0285e8c12fa7a1408">String</a> &amp;lat_retr_name, const <a class="el" href="mystring_8h.html#ab1ff59b63d1f9de0285e8c12fa7a1408">String</a> &amp;lon_retr_name, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;dim)</td></tr>
<tr class="memdesc:adba747ee343e17e6d1276a45f76a36e5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check that the retrieval grids are defined for each atmosphere dim.  <a href="jacobian_8cc.html#adba747ee343e17e6d1276a45f76a36e5">More...</a><br /></td></tr>
<tr class="separator:adba747ee343e17e6d1276a45f76a36e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab057286f38b17c69e6a58b3dcb402e05"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jacobian_8cc.html#ab057286f38b17c69e6a58b3dcb402e05">get_perturbation_gridpos</a> (<a class="el" href="interpolation_8h.html#a3ddcc9ca4ac36049e11e4593ad3ddb84">ArrayOfGridPos</a> &amp;gp, const <a class="el" href="classVector.html">Vector</a> &amp;atm_grid, const <a class="el" href="classVector.html">Vector</a> &amp;jac_grid, const bool &amp;is_pressure)</td></tr>
<tr class="memdesc:ab057286f38b17c69e6a58b3dcb402e05"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate array of <a class="el" href="structGridPos.html" title="Structure to store a grid position.">GridPos</a> for perturbation interpolation.  <a href="jacobian_8cc.html#ab057286f38b17c69e6a58b3dcb402e05">More...</a><br /></td></tr>
<tr class="separator:ab057286f38b17c69e6a58b3dcb402e05"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a362a4b0fb49894855c43b46b4decefe9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jacobian_8cc.html#a362a4b0fb49894855c43b46b4decefe9">get_perturbation_limit</a> (<a class="el" href="array_8h.html#a57f6f637ae2061568e4984e541c91d16">ArrayOfIndex</a> &amp;limit, const <a class="el" href="classVector.html">Vector</a> &amp;pert_grid, const <a class="el" href="classVector.html">Vector</a> &amp;atm_limit)</td></tr>
<tr class="memdesc:a362a4b0fb49894855c43b46b4decefe9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get limits for perturbation of a box.  <a href="jacobian_8cc.html#a362a4b0fb49894855c43b46b4decefe9">More...</a><br /></td></tr>
<tr class="separator:a362a4b0fb49894855c43b46b4decefe9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a37ec4470745481009d04f1061239bfe9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jacobian_8cc.html#a37ec4470745481009d04f1061239bfe9">get_perturbation_range</a> (<a class="el" href="classRange.html">Range</a> &amp;range, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;index, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;length)</td></tr>
<tr class="memdesc:a37ec4470745481009d04f1061239bfe9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get range for perturbation.  <a href="jacobian_8cc.html#a37ec4470745481009d04f1061239bfe9">More...</a><br /></td></tr>
<tr class="separator:a37ec4470745481009d04f1061239bfe9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a329487a0f680f3bfa49eeb12606b6cae"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jacobian_8cc.html#a329487a0f680f3bfa49eeb12606b6cae">perturbation_field_1d</a> (<a class="el" href="classVectorView.html">VectorView</a> field, const <a class="el" href="interpolation_8h.html#a3ddcc9ca4ac36049e11e4593ad3ddb84">ArrayOfGridPos</a> &amp;p_gp, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;p_pert_n, const <a class="el" href="classRange.html">Range</a> &amp;p_range, const <a class="el" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> &amp;size, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;method)</td></tr>
<tr class="memdesc:a329487a0f680f3bfa49eeb12606b6cae"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the 1D perturbation for a relative perturbation.  <a href="jacobian_8cc.html#a329487a0f680f3bfa49eeb12606b6cae">More...</a><br /></td></tr>
<tr class="separator:a329487a0f680f3bfa49eeb12606b6cae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6fe753e436d55d12e26380680b4032c4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jacobian_8cc.html#a6fe753e436d55d12e26380680b4032c4">perturbation_field_2d</a> (<a class="el" href="classMatrixView.html">MatrixView</a> field, const <a class="el" href="interpolation_8h.html#a3ddcc9ca4ac36049e11e4593ad3ddb84">ArrayOfGridPos</a> &amp;p_gp, const <a class="el" href="interpolation_8h.html#a3ddcc9ca4ac36049e11e4593ad3ddb84">ArrayOfGridPos</a> &amp;lat_gp, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;p_pert_n, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;lat_pert_n, const <a class="el" href="classRange.html">Range</a> &amp;p_range, const <a class="el" href="classRange.html">Range</a> &amp;lat_range, const <a class="el" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> &amp;size, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;method)</td></tr>
<tr class="memdesc:a6fe753e436d55d12e26380680b4032c4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the 2D perturbation for a relative perturbation.  <a href="jacobian_8cc.html#a6fe753e436d55d12e26380680b4032c4">More...</a><br /></td></tr>
<tr class="separator:a6fe753e436d55d12e26380680b4032c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a849c9a5b1ef64bc8be0e3420e06c996f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jacobian_8cc.html#a849c9a5b1ef64bc8be0e3420e06c996f">perturbation_field_3d</a> (<a class="el" href="classTensor3View.html">Tensor3View</a> field, const <a class="el" href="interpolation_8h.html#a3ddcc9ca4ac36049e11e4593ad3ddb84">ArrayOfGridPos</a> &amp;p_gp, const <a class="el" href="interpolation_8h.html#a3ddcc9ca4ac36049e11e4593ad3ddb84">ArrayOfGridPos</a> &amp;lat_gp, const <a class="el" href="interpolation_8h.html#a3ddcc9ca4ac36049e11e4593ad3ddb84">ArrayOfGridPos</a> &amp;lon_gp, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;p_pert_n, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;lat_pert_n, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;lon_pert_n, const <a class="el" href="classRange.html">Range</a> &amp;p_range, const <a class="el" href="classRange.html">Range</a> &amp;lat_range, const <a class="el" href="classRange.html">Range</a> &amp;lon_range, const <a class="el" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> &amp;size, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;method)</td></tr>
<tr class="memdesc:a849c9a5b1ef64bc8be0e3420e06c996f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the 3D perturbation for a relative perturbation.  <a href="jacobian_8cc.html#a849c9a5b1ef64bc8be0e3420e06c996f">More...</a><br /></td></tr>
<tr class="separator:a849c9a5b1ef64bc8be0e3420e06c996f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2d1debf80983068efafcf94b97bc3e8f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jacobian_8cc.html#a2d1debf80983068efafcf94b97bc3e8f">polynomial_basis_func</a> (<a class="el" href="classVector.html">Vector</a> &amp;b, const <a class="el" href="classVector.html">Vector</a> &amp;x, const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;poly_coeff)</td></tr>
<tr class="memdesc:a2d1debf80983068efafcf94b97bc3e8f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates polynomial basis functions.  <a href="jacobian_8cc.html#a2d1debf80983068efafcf94b97bc3e8f">More...</a><br /></td></tr>
<tr class="separator:a2d1debf80983068efafcf94b97bc3e8f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b0a2d82519984f6a672de609a3e5219"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="jacobian_8cc.html#a0b0a2d82519984f6a672de609a3e5219">vmrunitscf</a> (<a class="el" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> &amp;x, const <a class="el" href="mystring_8h.html#ab1ff59b63d1f9de0285e8c12fa7a1408">String</a> &amp;unit, const <a class="el" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> &amp;vmr, const <a class="el" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> &amp;p, const <a class="el" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> &amp;t)</td></tr>
<tr class="memdesc:a0b0a2d82519984f6a672de609a3e5219"><td class="mdescLeft">&#160;</td><td class="mdescRight">vmrunitscf  <a href="jacobian_8cc.html#a0b0a2d82519984f6a672de609a3e5219">More...</a><br /></td></tr>
<tr class="separator:a0b0a2d82519984f6a672de609a3e5219"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Routines for setting up the jacobian. </p>
<dl class="section author"><dt>Author</dt><dd>Mattias Ekstrom <a href="#" onclick="location.href='mai'+'lto:'+'eks'+'tr'+'om@'+'rs'+'s.c'+'ha'+'lme'+'rs'+'.se'; return false;">ekstr<span style="display: none;">.nosp@m.</span>om@r<span style="display: none;">.nosp@m.</span>ss.ch<span style="display: none;">.nosp@m.</span>alme<span style="display: none;">.nosp@m.</span>rs.se</a> </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2004-09-14 </dd></dl>

<p class="definition">Definition in file <a class="el" href="jacobian_8cc_source.html">jacobian.cc</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a4a739deb98ebee7f6e70ee0a85901efd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4a739deb98ebee7f6e70ee0a85901efd">&#9670;&nbsp;</a></span>calc_nd_field()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void calc_nd_field </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classTensor3View.html">Tensor3View</a> &amp;&#160;</td>
          <td class="paramname"><em>nd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classVectorView.html">VectorView</a> &amp;&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classTensor3View.html">Tensor3View</a> &amp;&#160;</td>
          <td class="paramname"><em>t</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate the number density field. </p>
<p>This function returns the number density for each grid point in the <a class="el" href="classTensor3View.html" title="The Tensor3View class.">Tensor3View</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">nd</td><td>The number density field </td></tr>
    <tr><td class="paramname">p</td><td>The pressure grid </td></tr>
    <tr><td class="paramname">t</td><td>The temperature field</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Mattias Ekstrom </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2005-06-03 </dd></dl>

<p class="definition">Definition at line <a class="el" href="jacobian_8cc_source.html#l00055">55</a> of file <a class="el" href="jacobian_8cc_source.html">jacobian.cc</a>.</p>

<p class="reference">References <a class="el" href="matpackIII_8h_source.html#l00157">ConstTensor3View::ncols()</a>, <a class="el" href="matpackI_8cc_source.html#l00175">ConstVectorView::nelem()</a>, <a class="el" href="matpackIII_8h_source.html#l00151">ConstTensor3View::npages()</a>, <a class="el" href="matpackIII_8h_source.html#l00154">ConstTensor3View::nrows()</a>, and <a class="el" href="physics__funcs_8cc_source.html#l00195">number_density()</a>.</p>

<p class="reference">Referenced by <a class="el" href="m__jacobian_8cc_source.html#l00309">jacobianCalcAbsSpeciesPerturbations()</a>.</p>

</div>
</div>
<a id="adba747ee343e17e6d1276a45f76a36e5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adba747ee343e17e6d1276a45f76a36e5">&#9670;&nbsp;</a></span>check_retrieval_grids()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool check_retrieval_grids </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="array_8h.html#abd238db55339e04459dc977232efcab2">ArrayOfVector</a> &amp;&#160;</td>
          <td class="paramname"><em>grids</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ostringstream &amp;&#160;</td>
          <td class="paramname"><em>os</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classVector.html">Vector</a> &amp;&#160;</td>
          <td class="paramname"><em>p_grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classVector.html">Vector</a> &amp;&#160;</td>
          <td class="paramname"><em>lat_grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classVector.html">Vector</a> &amp;&#160;</td>
          <td class="paramname"><em>lon_grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classVector.html">Vector</a> &amp;&#160;</td>
          <td class="paramname"><em>p_retr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classVector.html">Vector</a> &amp;&#160;</td>
          <td class="paramname"><em>lat_retr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classVector.html">Vector</a> &amp;&#160;</td>
          <td class="paramname"><em>lon_retr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="mystring_8h.html#ab1ff59b63d1f9de0285e8c12fa7a1408">String</a> &amp;&#160;</td>
          <td class="paramname"><em>p_retr_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="mystring_8h.html#ab1ff59b63d1f9de0285e8c12fa7a1408">String</a> &amp;&#160;</td>
          <td class="paramname"><em>lat_retr_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="mystring_8h.html#ab1ff59b63d1f9de0285e8c12fa7a1408">String</a> &amp;&#160;</td>
          <td class="paramname"><em>lon_retr_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>dim</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check that the retrieval grids are defined for each atmosphere dim. </p>
<p>This function checks for the given atmosphere dimension that I) the retrieval grids are defined II) and that they are covered by the corresponding atmospheric grid. If not the return is false and an output string is created to print the error to the user. If the grids are ok they are stored in an array and true is returned.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">grids</td><td>The array of retrieval grids. </td></tr>
    <tr><td class="paramname">os</td><td>The output string stream. </td></tr>
    <tr><td class="paramname">p_grid</td><td>The atmospheric pressure grid </td></tr>
    <tr><td class="paramname">lat_grid</td><td>The atmospheric latitude grid </td></tr>
    <tr><td class="paramname">lon_grid</td><td>The atmospheric longitude grid </td></tr>
    <tr><td class="paramname">p_retr</td><td>The pressure retrieval grid. </td></tr>
    <tr><td class="paramname">lat_retr</td><td>The latitude retrieval grid. </td></tr>
    <tr><td class="paramname">lon_retr</td><td>The longitude retrieval grid. </td></tr>
    <tr><td class="paramname">p_retr_name</td><td>The control file name used for the pressure retrieval grid. </td></tr>
    <tr><td class="paramname">lat_retr_name</td><td>The control file name for the latitude retrieval grid. </td></tr>
    <tr><td class="paramname">lon_retr_name</td><td>The control file name for the longitude retrieval grid. </td></tr>
    <tr><td class="paramname">dim</td><td>The atmosphere dimension </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Boolean for check.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Mattias Ekstrom </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2005-05-11 </dd></dl>

<p class="definition">Definition at line <a class="el" href="jacobian_8cc_source.html#l00104">104</a> of file <a class="el" href="jacobian_8cc_source.html">jacobian.cc</a>.</p>

<p class="reference">References <a class="el" href="logic_8cc_source.html#l00303">is_decreasing()</a>, <a class="el" href="logic_8cc_source.html#l00258">is_increasing()</a>, and <a class="el" href="matpackI_8cc_source.html#l00175">ConstVectorView::nelem()</a>.</p>

<p class="reference">Referenced by <a class="el" href="m__jacobian_8cc_source.html#l00180">jacobianAddAbsSpecies()</a>, and <a class="el" href="m__jacobian_8cc_source.html#l01281">jacobianAddTemperature()</a>.</p>

</div>
</div>
<a id="ab057286f38b17c69e6a58b3dcb402e05"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab057286f38b17c69e6a58b3dcb402e05">&#9670;&nbsp;</a></span>get_perturbation_gridpos()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void get_perturbation_gridpos </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="interpolation_8h.html#a3ddcc9ca4ac36049e11e4593ad3ddb84">ArrayOfGridPos</a> &amp;&#160;</td>
          <td class="paramname"><em>gp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classVector.html">Vector</a> &amp;&#160;</td>
          <td class="paramname"><em>atm_grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classVector.html">Vector</a> &amp;&#160;</td>
          <td class="paramname"><em>jac_grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool &amp;&#160;</td>
          <td class="paramname"><em>is_pressure</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate array of <a class="el" href="structGridPos.html" title="Structure to store a grid position.">GridPos</a> for perturbation interpolation. </p>
<p>This function constructs a perturbation grid which consists of the given retrieval grid with an extra endpoint added at each end. These endpoints lies outside the atmospheric grid. This enables the interpolation of an perturbation on the perturbation grid to be interpolated to the atmospheric grid. For this reason the function returns an ArrayOfGridPos.</p>
<p>If the atmospheric grid is a pressure grid, interpolation is made in logarithm of the atmospheric grid.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">gp</td><td><a class="el" href="classArray.html" title="This can be used to make arrays out of anything.">Array</a> of <a class="el" href="structGridPos.html" title="Structure to store a grid position.">GridPos</a> for interpolation. </td></tr>
    <tr><td class="paramname">atm_grid</td><td>Atmospheric grid. </td></tr>
    <tr><td class="paramname">jac_grid</td><td>Retrieval grid. </td></tr>
    <tr><td class="paramname">is_pressure</td><td>True for pressure grid</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Mattias Ekstrom </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2005-05-12 </dd></dl>

<p class="definition">Definition at line <a class="el" href="jacobian_8cc_source.html#l00229">229</a> of file <a class="el" href="jacobian_8cc_source.html">jacobian.cc</a>.</p>

<p class="reference">References <a class="el" href="interpolation_8cc_source.html#l00167">gridpos()</a>, <a class="el" href="matpackI_8cc_source.html#l00175">ConstVectorView::nelem()</a>, and <a class="el" href="special__interp_8cc_source.html#l00810">p2gridpos()</a>.</p>

<p class="reference">Referenced by <a class="el" href="m__jacobian_8cc_source.html#l00309">jacobianCalcAbsSpeciesPerturbations()</a>, and <a class="el" href="m__jacobian_8cc_source.html#l01408">jacobianCalcTemperaturePerturbations()</a>.</p>

</div>
</div>
<a id="a362a4b0fb49894855c43b46b4decefe9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a362a4b0fb49894855c43b46b4decefe9">&#9670;&nbsp;</a></span>get_perturbation_limit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void get_perturbation_limit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="array_8h.html#a57f6f637ae2061568e4984e541c91d16">ArrayOfIndex</a> &amp;&#160;</td>
          <td class="paramname"><em>limit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classVector.html">Vector</a> &amp;&#160;</td>
          <td class="paramname"><em>pert_grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classVector.html">Vector</a> &amp;&#160;</td>
          <td class="paramname"><em>atm_limit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get limits for perturbation of a box. </p>
<p>This is a helper function that calculates the limits where the perturbation should be added to the perturbation grid. This is needed for example by the particle perturbation that only should be applied for the cloudbox. The limits are defined as the outermost points lying within or just outside the box limits.</p>
<p>The atmospheric limits should be given in the same unit as the perturbation grid. And only the first and last element will be considered as limits.</p>
<p>Assertions are used to perform checks. The input grids are checked so that the atmospheric limits are containg within the perturbation grid. The limit indices are checked so that they are ordered in increasing order before return.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">limit</td><td>The limit indices in the perturbation grid </td></tr>
    <tr><td class="paramname">pert_grid</td><td>The perturbation grid </td></tr>
    <tr><td class="paramname">atm_limit</td><td>The atmospheric limits of the box.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Mattias Ekstrom </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2005-02-25 </dd></dl>

<p class="definition">Definition at line <a class="el" href="jacobian_8cc_source.html#l00288">288</a> of file <a class="el" href="jacobian_8cc_source.html">jacobian.cc</a>.</p>

<p class="reference">References <a class="el" href="logic_8cc_source.html#l00303">is_decreasing()</a>, and <a class="el" href="matpackI_8cc_source.html#l00175">ConstVectorView::nelem()</a>.</p>

</div>
</div>
<a id="a37ec4470745481009d04f1061239bfe9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a37ec4470745481009d04f1061239bfe9">&#9670;&nbsp;</a></span>get_perturbation_range()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void get_perturbation_range </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classRange.html">Range</a> &amp;&#160;</td>
          <td class="paramname"><em>range</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get range for perturbation. </p>
<p>This is a helper function that calculates the range in which the perturbation should be added to the perturbation grid. This is needed to handle the edge effects. At the edges we want the perturbation to continue outwards.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">range</td><td>The range in the perturbation grid. </td></tr>
    <tr><td class="paramname">index</td><td>The index of the perturbation in the retrieval grid. </td></tr>
    <tr><td class="paramname">length</td><td>The length of retrieval grid</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Mattias Ekstrom </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2004-10-14 </dd></dl>

<p class="definition">Definition at line <a class="el" href="jacobian_8cc_source.html#l00340">340</a> of file <a class="el" href="jacobian_8cc_source.html">jacobian.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="m__jacobian_8cc_source.html#l00309">jacobianCalcAbsSpeciesPerturbations()</a>, and <a class="el" href="m__jacobian_8cc_source.html#l01408">jacobianCalcTemperaturePerturbations()</a>.</p>

</div>
</div>
<a id="afe8ca4da49b69f5a7aa83b641748ce03"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afe8ca4da49b69f5a7aa83b641748ce03">&#9670;&nbsp;</a></span>operator&lt;&lt;()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ostream&amp; operator&lt;&lt; </td>
          <td>(</td>
          <td class="paramtype">ostream &amp;&#160;</td>
          <td class="paramname"><em>os</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classRetrievalQuantity.html">RetrievalQuantity</a> &amp;&#160;</td>
          <td class="paramname"><em>ot</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Output operator for <a class="el" href="classRetrievalQuantity.html" title="Contains the data for one retrieval quantity.">RetrievalQuantity</a>. </p>
<dl class="section author"><dt>Author</dt><dd>Mattias Ekstrom </dd></dl>

<p class="definition">Definition at line <a class="el" href="jacobian_8cc_source.html#l00031">31</a> of file <a class="el" href="jacobian_8cc_source.html">jacobian.cc</a>.</p>

<p class="reference">References <a class="el" href="jacobian_8h_source.html#l00096">RetrievalQuantity::Analytical()</a>, <a class="el" href="jacobian_8h_source.html#l00087">RetrievalQuantity::MainTag()</a>, <a class="el" href="jacobian_8h_source.html#l00093">RetrievalQuantity::Mode()</a>, and <a class="el" href="jacobian_8h_source.html#l00090">RetrievalQuantity::Subtag()</a>.</p>

</div>
</div>
<a id="a329487a0f680f3bfa49eeb12606b6cae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a329487a0f680f3bfa49eeb12606b6cae">&#9670;&nbsp;</a></span>perturbation_field_1d()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void perturbation_field_1d </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classVectorView.html">VectorView</a>&#160;</td>
          <td class="paramname"><em>field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="interpolation_8h.html#a3ddcc9ca4ac36049e11e4593ad3ddb84">ArrayOfGridPos</a> &amp;&#160;</td>
          <td class="paramname"><em>p_gp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>p_pert_n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classRange.html">Range</a> &amp;&#160;</td>
          <td class="paramname"><em>p_range</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> &amp;&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>method</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate the 1D perturbation for a relative perturbation. </p>
<p>This is a helper function that interpolated the perturbation field for a 1D relative perturbation onto the atmospheric field.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">field</td><td>The interpolated perturbation field. </td></tr>
    <tr><td class="paramname">p_gp</td><td>The <a class="el" href="structGridPos.html" title="Structure to store a grid position.">GridPos</a> for interpolation. </td></tr>
    <tr><td class="paramname">p_pert_n</td><td>The number of perturbations. </td></tr>
    <tr><td class="paramname">p_range</td><td>The perturbation range in the perturbation grid. </td></tr>
    <tr><td class="paramname">size</td><td>The size of the perturbation. </td></tr>
    <tr><td class="paramname">method</td><td>Relative perturbation==0, absolute==1</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Mattias Ekstrom </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2005-05-11 </dd></dl>

<p class="definition">Definition at line <a class="el" href="jacobian_8cc_source.html#l00370">370</a> of file <a class="el" href="jacobian_8cc_source.html">jacobian.cc</a>.</p>

<p class="reference">References <a class="el" href="interpolation_8cc_source.html#l01000">interp()</a>, <a class="el" href="interpolation_8cc_source.html#l00756">interpweights()</a>, <a class="el" href="array_8h_source.html#l00172">Array&lt; base &gt;::nelem()</a>, and <a class="el" href="matpackI_8cc_source.html#l00175">ConstVectorView::nelem()</a>.</p>

<p class="reference">Referenced by <a class="el" href="m__jacobian_8cc_source.html#l00309">jacobianCalcAbsSpeciesPerturbations()</a>, and <a class="el" href="m__jacobian_8cc_source.html#l01408">jacobianCalcTemperaturePerturbations()</a>.</p>

</div>
</div>
<a id="a6fe753e436d55d12e26380680b4032c4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6fe753e436d55d12e26380680b4032c4">&#9670;&nbsp;</a></span>perturbation_field_2d()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void perturbation_field_2d </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMatrixView.html">MatrixView</a>&#160;</td>
          <td class="paramname"><em>field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="interpolation_8h.html#a3ddcc9ca4ac36049e11e4593ad3ddb84">ArrayOfGridPos</a> &amp;&#160;</td>
          <td class="paramname"><em>p_gp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="interpolation_8h.html#a3ddcc9ca4ac36049e11e4593ad3ddb84">ArrayOfGridPos</a> &amp;&#160;</td>
          <td class="paramname"><em>lat_gp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>p_pert_n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>lat_pert_n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classRange.html">Range</a> &amp;&#160;</td>
          <td class="paramname"><em>p_range</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classRange.html">Range</a> &amp;&#160;</td>
          <td class="paramname"><em>lat_range</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> &amp;&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>method</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate the 2D perturbation for a relative perturbation. </p>
<p>This is a helper function that interpolated the perturbation field for a 2D relative perturbation onto the atmospheric field.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">field</td><td>The interpolated perturbation field. </td></tr>
    <tr><td class="paramname">p_gp</td><td>The <a class="el" href="structGridPos.html" title="Structure to store a grid position.">GridPos</a> for interpolation in the 1st dim. </td></tr>
    <tr><td class="paramname">lat_gp</td><td>The <a class="el" href="structGridPos.html" title="Structure to store a grid position.">GridPos</a> for interpolation in the 2nd dim. </td></tr>
    <tr><td class="paramname">p_pert_n</td><td>The number of perturbations in the 1st dim. </td></tr>
    <tr><td class="paramname">lat_pert_n</td><td>The number of perturbations in the 2nd dim. </td></tr>
    <tr><td class="paramname">p_range</td><td>The perturbation range in the 1st dim. </td></tr>
    <tr><td class="paramname">lat_range</td><td>The perturbation range in the 2nd dim. </td></tr>
    <tr><td class="paramname">size</td><td>The size of the perturbation. </td></tr>
    <tr><td class="paramname">method</td><td>Relative perturbation==0, absolute==1</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Mattias Ekstrom </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2005-05-11 </dd></dl>

<p class="definition">Definition at line <a class="el" href="jacobian_8cc_source.html#l00415">415</a> of file <a class="el" href="jacobian_8cc_source.html">jacobian.cc</a>.</p>

<p class="reference">References <a class="el" href="interpolation_8cc_source.html#l01000">interp()</a>, <a class="el" href="interpolation_8cc_source.html#l00756">interpweights()</a>, <a class="el" href="matpackI_8cc_source.html#l00802">ConstMatrixView::ncols()</a>, <a class="el" href="array_8h_source.html#l00172">Array&lt; base &gt;::nelem()</a>, and <a class="el" href="matpackI_8cc_source.html#l00796">ConstMatrixView::nrows()</a>.</p>

<p class="reference">Referenced by <a class="el" href="m__jacobian_8cc_source.html#l00309">jacobianCalcAbsSpeciesPerturbations()</a>, and <a class="el" href="m__jacobian_8cc_source.html#l01408">jacobianCalcTemperaturePerturbations()</a>.</p>

</div>
</div>
<a id="a849c9a5b1ef64bc8be0e3420e06c996f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a849c9a5b1ef64bc8be0e3420e06c996f">&#9670;&nbsp;</a></span>perturbation_field_3d()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void perturbation_field_3d </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classTensor3View.html">Tensor3View</a>&#160;</td>
          <td class="paramname"><em>field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="interpolation_8h.html#a3ddcc9ca4ac36049e11e4593ad3ddb84">ArrayOfGridPos</a> &amp;&#160;</td>
          <td class="paramname"><em>p_gp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="interpolation_8h.html#a3ddcc9ca4ac36049e11e4593ad3ddb84">ArrayOfGridPos</a> &amp;&#160;</td>
          <td class="paramname"><em>lat_gp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="interpolation_8h.html#a3ddcc9ca4ac36049e11e4593ad3ddb84">ArrayOfGridPos</a> &amp;&#160;</td>
          <td class="paramname"><em>lon_gp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>p_pert_n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>lat_pert_n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>lon_pert_n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classRange.html">Range</a> &amp;&#160;</td>
          <td class="paramname"><em>p_range</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classRange.html">Range</a> &amp;&#160;</td>
          <td class="paramname"><em>lat_range</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classRange.html">Range</a> &amp;&#160;</td>
          <td class="paramname"><em>lon_range</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> &amp;&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>method</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate the 3D perturbation for a relative perturbation. </p>
<p>This is a helper function that interpolated the perturbation field for a 3D relative perturbation onto the atmospheric field.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">field</td><td>The interpolated perturbation field. </td></tr>
    <tr><td class="paramname">p_gp</td><td>The <a class="el" href="structGridPos.html" title="Structure to store a grid position.">GridPos</a> for interpolation in the 1st dim. </td></tr>
    <tr><td class="paramname">lat_gp</td><td>The <a class="el" href="structGridPos.html" title="Structure to store a grid position.">GridPos</a> for interpolation in the 2nd dim. </td></tr>
    <tr><td class="paramname">lon_gp</td><td>The <a class="el" href="structGridPos.html" title="Structure to store a grid position.">GridPos</a> for interpolation in the 3rd dim. </td></tr>
    <tr><td class="paramname">p_pert_n</td><td>The number of perturbations in the 1st dim. </td></tr>
    <tr><td class="paramname">lat_pert_n</td><td>The number of perturbations in the 2nd dim. </td></tr>
    <tr><td class="paramname">lon_pert_n</td><td>The number of perturbations in the 3rd dim. </td></tr>
    <tr><td class="paramname">p_range</td><td>The perturbation range in the 1st dim. </td></tr>
    <tr><td class="paramname">lat_range</td><td>The perturbation range in the 2nd dim. </td></tr>
    <tr><td class="paramname">lon_range</td><td>The perturbation range in the 3rd dim. </td></tr>
    <tr><td class="paramname">size</td><td>The size of the perturbation. </td></tr>
    <tr><td class="paramname">method</td><td>Set to 0 for relative, and 1 for absolute.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Mattias Ekstrom </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2005-05-11 </dd></dl>

<p class="definition">Definition at line <a class="el" href="jacobian_8cc_source.html#l00466">466</a> of file <a class="el" href="jacobian_8cc_source.html">jacobian.cc</a>.</p>

<p class="reference">References <a class="el" href="interpolation_8cc_source.html#l01000">interp()</a>, <a class="el" href="interpolation_8cc_source.html#l00756">interpweights()</a>, <a class="el" href="matpackIII_8h_source.html#l00157">ConstTensor3View::ncols()</a>, <a class="el" href="array_8h_source.html#l00172">Array&lt; base &gt;::nelem()</a>, <a class="el" href="matpackIII_8h_source.html#l00151">ConstTensor3View::npages()</a>, and <a class="el" href="matpackIII_8h_source.html#l00154">ConstTensor3View::nrows()</a>.</p>

<p class="reference">Referenced by <a class="el" href="m__jacobian_8cc_source.html#l00309">jacobianCalcAbsSpeciesPerturbations()</a>, and <a class="el" href="m__jacobian_8cc_source.html#l01408">jacobianCalcTemperaturePerturbations()</a>.</p>

</div>
</div>
<a id="a2d1debf80983068efafcf94b97bc3e8f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2d1debf80983068efafcf94b97bc3e8f">&#9670;&nbsp;</a></span>polynomial_basis_func()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void polynomial_basis_func </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classVector.html">Vector</a> &amp;&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classVector.html">Vector</a> &amp;&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#aedca4b4670b166565b5b40c700d65a7c">Index</a> &amp;&#160;</td>
          <td class="paramname"><em>poly_coeff</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates polynomial basis functions. </p>
<p>The basis function is b(x) = 1 for poly_coeff = 0. For higher coefficients, x^poly_coeff - m, where first the range covered by x* is normalised to [-1,1] and m is selected in such way that sum(b) = 0.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">b</td><td>Calculated basis function. </td></tr>
    <tr><td class="paramname">x</td><td>The grid over which the fit shall be performed. </td></tr>
    <tr><td class="paramname">poly_coeff</td><td>Polynomial coefficient.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Patrick Eriksson </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2008-11-07 </dd></dl>

<p class="definition">Definition at line <a class="el" href="jacobian_8cc_source.html#l00513">513</a> of file <a class="el" href="jacobian_8cc_source.html">jacobian.cc</a>.</p>

<p class="reference">References <a class="el" href="continua_8cc_source.html#l14561">dx</a>, <a class="el" href="continua_8cc_source.html#l13097">max</a>, <a class="el" href="matpackI_8cc_source.html#l01862">mean()</a>, <a class="el" href="continua_8cc_source.html#l13096">min</a>, <a class="el" href="matpackI_8cc_source.html#l00175">ConstVectorView::nelem()</a>, and <a class="el" href="matpackI_8cc_source.html#l00771">Vector::resize()</a>.</p>

<p class="reference">Referenced by <a class="el" href="m__jacobian_8cc_source.html#l00610">jacobianCalcFreqShiftAndStretchInterp()</a>, <a class="el" href="m__jacobian_8cc_source.html#l00849">jacobianCalcPointingZaInterp()</a>, <a class="el" href="m__jacobian_8cc_source.html#l00976">jacobianCalcPointingZaRecalc()</a>, and <a class="el" href="m__jacobian_8cc_source.html#l01190">jacobianCalcPolyfit()</a>.</p>

</div>
</div>
<a id="a0b0a2d82519984f6a672de609a3e5219"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0b0a2d82519984f6a672de609a3e5219">&#9670;&nbsp;</a></span>vmrunitscf()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void vmrunitscf </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> &amp;&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="mystring_8h.html#ab1ff59b63d1f9de0285e8c12fa7a1408">String</a> &amp;&#160;</td>
          <td class="paramname"><em>unit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> &amp;&#160;</td>
          <td class="paramname"><em>vmr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> &amp;&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="matpack_8h.html#ad9a8dbb27c0bbea7271d916036122f6a">Numeric</a> &amp;&#160;</td>
          <td class="paramname"><em>t</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>vmrunitscf </p>
<p>Scale factor for conversion between gas species units.</p>
<p>The function finds the factor with which the total absorption of a gas species shall be multiplicated to match the selected (jacobian) unit.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">x</td><td>Out: scale factor </td></tr>
    <tr><td class="paramname">unit</td><td>Unit selected. </td></tr>
    <tr><td class="paramname">vmr</td><td>VMR value. </td></tr>
    <tr><td class="paramname">p</td><td>Pressure </td></tr>
    <tr><td class="paramname">t</td><td>Temperature.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Patrick Eriksson </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2009-10-08 </dd></dl>

<p class="definition">Definition at line <a class="el" href="jacobian_8cc_source.html#l00561">561</a> of file <a class="el" href="jacobian_8cc_source.html">jacobian.cc</a>.</p>

<p class="reference">References <a class="el" href="physics__funcs_8cc_source.html#l00195">number_density()</a>.</p>

<p class="reference">Referenced by <a class="el" href="m__rte_8cc_source.html#l00789">iyBeerLambertStandardClearsky()</a>, and <a class="el" href="m__rte_8cc_source.html#l01240">iyEmissionStandardClearsky()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="jacobian_8cc.html">jacobian.cc</a></li>
    <li class="footer">Generated by <a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.8.20 </li>
  </ul>
</div>
</body>
</html>
